# 广西自动化学会会员管理系统 - 关键源代码
## 一、核心配置与类型定义
### 1.1 Supabase配置 (supabase.ts)
```typescript
import { createClient } from '@supabase/supabase-js';
const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;
export const supabase = createClient(supabaseUrl, supabaseAnonKey);
```

### 1.2 类型定义 (types/index.ts)
```typescript
export interface Profile {
  id: string;
  email: string;
  full_name: string;
  role: 'member' | 'admin';
  membership_level?: string;
  membership_status?: 'active' | 'inactive' | 'pending';
  membership_duration_days?: number;
  payment_status?: string;
  join_date?: string;
  phone?: string;
  institution?: string;
  created_at: string;
}

export interface Application {
  id: string;
  user_id: string;
  full_name: string;
  content: string;
  status: 'pending' | 'approved' | 'rejected';
  created_at: string;
}

export interface AppMessage {
  id: string;
  sender_id: string;
  receiver_id: string;
  subject: string;
  content: string;
  message_type: 'text' | 'event_application';
  is_read: boolean;
  created_at: string;
}
```

## 二、认证与授权
### 2.1 认证上下文 (AuthContext.tsx)
```typescript
import React, { createContext, useContext, useEffect, useState } from 'react';
import type { User, Session } from '@supabase/supabase-js';
import { supabase } from '../lib/supabase';
import type { Profile } from '../types';

interface AuthContextType {
  user: User | null;
  session: Session | null;
  profile: Profile | null;
  loading: boolean;
  isAdmin: boolean;
  signOut: () => Promise<void>;
}

const AuthContext = createContext<AuthContextType>({
  user: null,
  session: null,
  profile: null,
  loading: true,
  isAdmin: false,
  signOut: async () => {},
});

export const useAuth = () => useContext(AuthContext);

export const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [user, setUser] = useState<User | null>(null);
  const [session, setSession] = useState<Session | null>(null);
  const [profile, setProfile] = useState<Profile | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    supabase.auth.getSession().then(({ data: { session } }) => {
      setSession(session);
      setUser(session?.user ?? null);
      if (session?.user) fetchProfile(session.user.id);
      else setLoading(false);
    }).catch(err => {
      console.error("Failed to get session:", err);
      setLoading(false);
    });

    const { data: { subscription: authSubscription } } = supabase.auth.onAuthStateChange((_event, session) => {
      setSession(session);
      setUser(session?.user ?? null);
      if (session?.user) fetchProfile(session.user.id);
      else {
        setProfile(null);
        setLoading(false);
      }
    });

    return () => authSubscription.unsubscribe();
  }, []);

  const fetchProfile = async (userId: string, retries = 3) => {
    try {
      const { data, error } = await supabase.from('profiles').select('*').eq('id', userId).single();
      if (error) {
        if (error.code === 'PGRST116' && retries > 0) {
          setTimeout(() => fetchProfile(userId, retries - 1), 1000);
          return;
        }
        console.error('Error fetching profile:', error);
        setLoading(false);
      } else {
        setProfile(data);
        setLoading(false);
      }
    } catch (err) {
      console.error('Unexpected error fetching profile:', err);
      setLoading(false);
    }
  };

  // 监听profile数据变化
  useEffect(() => {
    if (!user) return;
    const profileChannel = supabase.channel(`profile:${user.id}`).on('postgres_changes', {
      event: '*', schema: 'public', table: 'profiles', filter: `id=eq.${user.id}`
    }, (payload) => {
      if (payload.new) setProfile(payload.new as Profile);
    }).subscribe();
    return () => profileChannel.unsubscribe();
  }, [user]);

  const signOut = async () => {
    await supabase.auth.signOut();
    setProfile(null);
    setUser(null);
    setSession(null);
  };

  const isAdmin = profile?.role === 'admin';
  return <AuthContext.Provider value={{ user, session, profile, loading, isAdmin, signOut }}>{children}</AuthContext.Provider>;
};
```

### 2.2 路由保护组件 (ProtectedRoute.tsx)
```typescript
import React from 'react';
import { Navigate, Outlet, useLocation } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';

interface ProtectedRouteProps {
  role?: 'member' | 'admin';
}

const ProtectedRoute: React.FC<ProtectedRouteProps> = ({ role }) => {
  const { user, profile, loading } = useAuth();
  const location = useLocation();
  if (loading) return <div>加载中...</div>;
  if (!user) return <Navigate to="/login" state={{ from: location }} replace />;
  if (role && profile?.role !== role) {
    return profile?.role === 'admin' ? <Navigate to="/admin" replace /> : <Navigate to="/member" replace />;
  }
  return <Outlet />;
};

export default ProtectedRoute;
```

## 三、应用路由与入口
### 3.1 应用路由 (App.tsx)
```typescript
import { Routes, Route } from 'react-router-dom';
import Login from './pages/Login';
import Register from './pages/Register';
import MemberDashboard from './pages/MemberDashboard';
import AdminDashboard from './pages/AdminDashboard';
import ProtectedRoute from './components/ProtectedRoute';

function App() {
  return (
    <div className="min-h-screen bg-gray-50">
      <Routes>
        <Route path="/login" element={<Login />} />
        <Route path="/register" element={<Register />} />
        <Route element={<ProtectedRoute role="member" />}>
          <Route path="/member/*" element={<MemberDashboard />} />
        </Route>
        <Route element={<ProtectedRoute role="admin" />}>
          <Route path="/admin/*" element={<AdminDashboard />} />
        </Route>
        <Route path="/" element={<Login />} />
      </Routes>
    </div>
  );
}

export default App;
```

### 3.2 应用入口 (main.tsx)
```typescript
import React from 'react';
import ReactDOM from 'react-dom/client';
import { BrowserRouter } from 'react-router-dom';
import { AuthProvider } from './context/AuthContext';
import App from './App';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <BrowserRouter>
      <AuthProvider>
        <App />
      </AuthProvider>
    </BrowserRouter>
  </React.StrictMode>,
);
```

## 四、核心页面组件
### 4.1 登录页面 (Login.tsx)
```typescript
import React, { useState } from 'react';
import { useNavigate, Link } from 'react-router-dom';
import { supabase } from '../lib/supabase';
import { useAuth } from '../context/AuthContext';

const Login: React.FC = () => {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const navigate = useNavigate();

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    setError(null);
    try {
      const { error } = await supabase.auth.signInWithPassword({ email, password });
      if (error) throw error;
      const { data } = await supabase.from('profiles').select('role').eq('email', email).single();
      navigate(data?.role === 'admin' ? '/admin' : '/member');
    } catch (err: any) {
      setError(err.message || '登录失败');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="flex min-h-screen items-center justify-center bg-gray-50 px-4 py-12">
      <div className="w-full max-w-md space-y-8 bg-white p-8 rounded-xl shadow-lg">
        <div className="text-center">
          <h2 className="text-3xl font-extrabold text-gray-900">广西自动化学会</h2>
          <p className="mt-2 text-sm text-gray-600">会员管理系统</p>
        </div>
        <form className="mt-8 space-y-6" onSubmit={handleLogin}>
          {error && <div className="p-3 text-red-700 bg-red-100 rounded-md text-sm">{error}</div>}
          <div>
            <label htmlFor="email" className="block text-sm font-medium text-gray-700">邮箱</label>
            <div className="mt-1">
              <input type="email" id="email" required className="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="your@email.com" value={email} onChange={(e) => setEmail(e.target.value)} />
            </div>
          </div>
          <div>
            <label htmlFor="password" className="block text-sm font-medium text-gray-700">密码</label>
            <div className="mt-1">
              <input type="password" id="password" required className="w-full px-3 py-2 border border-gray-300 rounded-md" placeholder="••••••••" value={password} onChange={(e) => setPassword(e.target.value)} />
            </div>
          </div>
          <div className="flex items-center justify-between">
            <div className="flex items-center">
              <input type="checkbox" id="remember-me" className="h-4 w-4 text-indigo-600" />
              <label htmlFor="remember-me" className="ml-2 text-sm text-gray-900">记住我</label>
            </div>
            <Link to="/forgot-password" className="text-sm text-indigo-600 hover:text-indigo-500">忘记密码？</Link>
          </div>
          <div>
            <button type="submit" disabled={loading} className="w-full py-2 px-4 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50">
              {loading ? '登录中...' : '登录'}
            </button>
          </div>
          <div className="text-center text-sm">
            <Link to="/register" className="text-indigo-600 hover:text-indigo-500">没有账号？立即注册</Link>
          </div>
        </form>
      </div>
    </div>
  );
};

export default Login;
```

### 4.2 会员仪表盘 (MemberDashboard.tsx - 核心部分)
```typescript
import React, { useState } from 'react';
import { Routes, Route, Link, useNavigate, useLocation } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';
import { LogOut, Menu, X } from 'lucide-react';

const MemberProfile: React.FC = () => {
  const { profile, loading, user } = useAuth();
  const [showEmailModal, setShowEmailModal] = useState(false);
  const [newEmail, setNewEmail] = useState('');
  const [loadingEmail, setLoadingEmail] = useState(false);

  const handleEmailChange = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!newEmail) return;
    setLoadingEmail(true);
    try {
        const { error } = await supabase.auth.updateUser({ email: newEmail });
        if (error) throw error;
        alert('验证邮件已发送！请查收确认。');
        setShowEmailModal(false);
        setNewEmail('');
    } catch (err: any) {
        alert('发送失败: ' + err.message);
    } finally {
        setLoadingEmail(false);
    }
  };

  if (loading) return <div>加载中...</div>;
  if (!profile) return <div className="bg-white p-6 rounded shadow"><h3 className="text-lg font-medium text-red-600">无法加载会员资料</h3></div>;

  const getLevelName = (level: string | undefined) => {
    switch(level) {
      case 'General': return '普通会员';
      case 'Student': return '学生会员';
      case 'Director': return '理事';
      case 'Chairman': return '理事长';
      case 'Vice Chairman': return '副理事长';
      case 'Secretary': return '秘书长';
      default: return level || '普通会员';
    }
  };

  const getPaymentStatus = (status: string | undefined, durationDays: number | undefined) => {
    if (durationDays && durationDays > 0) return '已缴费';
    if (!status) return '未缴费';
    if (status.toLowerCase() === 'paid') return '已缴费';
    if (status.toLowerCase() === 'unpaid') return '未缴费';
    return status;
  };

  return (
    <div className="bg-white shadow overflow-hidden sm:rounded-lg">
      <div className="px-4 py-5 sm:px-6">
        <h3 className="text-lg leading-6 font-medium text-gray-900">会员信息</h3>
        <p className="mt-1 max-w-2xl text-sm text-gray-500">个人详情与会员状态</p>
      </div>
      <div className="border-t border-gray-200">
        <dl>
          <div className="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt className="text-sm font-medium text-gray-500">姓名</dt>
            <dd className="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">{profile.full_name}</dd>
          </div>
          <div className="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt className="text-sm font-medium text-gray-500">电子邮箱</dt>
            <dd className="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">{profile.email}</dd>
          </div>
          <div className="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt className="text-sm font-medium text-gray-500">会员等级</dt>
            <dd className="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">{getLevelName(profile.membership_level)}</dd>
          </div>
          <div className="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt className="text-sm font-medium text-gray-500">会员状态</dt>
            <dd className="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
              <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${profile.membership_status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`}>
                {profile.membership_status === 'active' ? '活跃' : '待审核'}
              </span>
            </dd>
          </div>
          <div className="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt className="text-sm font-medium text-gray-500">缴费状态</dt>
            <dd className="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">{getPaymentStatus(profile.payment_status, profile.membership_duration_days)}</dd>
          </div>
          <div className="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt className="text-sm font-medium text-gray-500">剩余时长</dt>
            <dd className="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">{profile.membership_duration_days || 0} 天</dd>
          </div>
        </dl>
      </div>
    </div>
  );
};
```

## 五、管理员功能模块
### 5.1 管理员仪表盘 (AdminDashboard.tsx - 核心部分)
```typescript
import React, { useEffect, useState } from 'react';
import { Routes, Route, Link, useNavigate, useLocation } from 'react-router-dom';
import { useAuth } from '../context/AuthContext';
import { supabase } from '../lib/supabase';
import type { Profile, Application } from '../types';
import * as XLSX from 'xlsx';
import { LogOut, Download, Edit, Check, X, Menu } from 'lucide-react';

const MemberList: React.FC = () => {
  const [members, setMembers] = useState<Profile[]>([]);
  const [loading, setLoading] = useState(true);
  const [editingId, setEditingId] = useState<string | null>(null);
  const [editForm, setEditForm] = useState<Partial<Profile>>({});

  useEffect(() => {
    fetchMembers();
  }, []);

  const fetchMembers = async () => {
    const { data, error } = await supabase.from('profiles').select('*').order('created_at', { ascending: false });
    if (error) console.error(error);
    else setMembers(data || []);
    setLoading(false);
  };

  const handleExport = () => {
    const data = members.map(m => ({
      "姓名": m.full_name,
      "邮箱": m.email,
      "角色": m.role === 'admin' ? '管理员' : '会员',
      "等级": m.membership_level,
      "状态": m.membership_status,
      "剩余天数": m.membership_duration_days,
      "电话": m.phone,
      "单位": m.institution,
      "加入日期": m.join_date
    }));
    const ws = XLSX.utils.json_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Members");
    XLSX.writeFile(wb, "members_list.xlsx");
  };

  const saveEdit = async (id: string) => {
    try {
      const { error } = await supabase.from('profiles').update(editForm).eq('id', id);
      if (error) throw error;
      setMembers(members.map(m => m.id === id ? { ...m, ...editForm } : m));
      setEditingId(null);
    } catch (err: any) {
      console.error('更新会员失败:', err);
      alert(`更新会员失败: ${err.message || '未知错误'}`);
    }
  };

  if (loading) return <div>加载中...</div>;

  return (
    <div className="bg-white shadow sm:rounded-lg">
      <div className="px-4 py-5 sm:px-6 flex justify-between items-center">
        <div><h3 className="text-lg font-medium text-gray-900">会员管理</h3></div>
        <button onClick={handleExport} className="inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-md shadow-sm hover:bg-green-700">
          <Download className="mr-2 h-4 w-4" /> 导出 Excel
        </button>
      </div>
      <div className="flex flex-col">
        <div className="overflow-x-auto">
          <table className="min-w-full divide-y divide-gray-200">
            <thead className="bg-gray-50">
              <tr>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">姓名/邮箱</th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">单位/电话</th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">等级/角色</th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">状态</th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">剩余时长</th>
                <th scope="col" className="relative px-6 py-3"><span className="sr-only">操作</span></th>
              </tr>
            </thead>
            <tbody className="bg-white divide-y divide-gray-200">
              {members.map((member) => (
                <tr key={member.id}>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="text-sm font-medium text-gray-900">{member.full_name}</div>
                    <div className="text-sm text-gray-500">{member.email}</div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="text-sm text-gray-900">{member.institution || '-'}</div>
                    <div className="text-sm text-gray-500">{member.phone}</div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    {editingId === member.id ? (
                      <div className="flex flex-col gap-2">
                        <select className="text-sm border rounded" value={editForm.membership_level} onChange={e => setEditForm({...editForm, membership_level: e.target.value})}>
                          <option value="General">普通会员</option>
                          <option value="Student">学生会员</option>
                          <option value="Director">理事</option>
                          <option value="Chairman">理事长</option>
                          <option value="Vice Chairman">副理事长</option>
                          <option value="Secretary">秘书长</option>
                        </select>
                        <select className="text-sm border rounded" value={editForm.role} onChange={e => setEditForm({...editForm, role: e.target.value as 'admin' | 'member'})}>
                          <option value="member">会员</option>
                          <option value="admin">管理员</option>
                        </select>
                      </div>
                    ) : (
                      <>
                        <div className="text-sm text-gray-900">{member.membership_level}</div>
                        <div className="text-xs text-gray-500">{member.role === 'admin' ? '管理员' : '会员'}</div>
                      </>
                    )}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${member.membership_status === 'active' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}`}>
                      {member.membership_status === 'active' ? '正常' : member.membership_status === 'pending' ? '待审核' : '已拒绝'}
                    </span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    {editingId === member.id ? (
                      <input type="number" min="0" className="text-sm border rounded" value={editForm.membership_duration_days} onChange={e => setEditForm({...editForm, membership_duration_days: parseInt(e.target.value) || 0})} />
                    ) : (
                      <div className="text-sm text-gray-900">{member.membership_duration_days || 0} 天</div>
                    )}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    {editingId === member.id ? (
                      <div className="flex gap-2 justify-end">
                        <button onClick={() => saveEdit(member.id)} className="text-green-600 hover:text-green-900"><Check className="h-5 w-5"/></button>
                        <button onClick={() => setEditingId(null)} className="text-red-600 hover:text-red-900"><X className="h-5 w-5"/></button>
                      </div>
                    ) : (
                      <button onClick={() => setEditingId(member.id)} className="text-indigo-600 hover:text-indigo-900"><Edit className="h-5 w-5"/></button>
                    )}
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
};

const ApplicationList: React.FC = () => {
  const [applications, setApplications] = useState<Application[]>([]);

  useEffect(() => {
    fetchApplications();
  }, []);

  const fetchApplications = async () => {
    const { data, error } = await supabase.from('applications').select('*').order('created_at', { ascending: false });
    if (error) console.error(error);
    else setApplications(data || []);
  };

  const updateStatus = async (id: string, status: 'approved' | 'rejected') => {
    const { data: applicationData, error: fetchError } = await supabase.from('applications').select('user_id').eq('id', id).single();
    if (fetchError) { console.error('Failed to fetch application:', fetchError); return; }

    const { error: updateAppError } = await supabase.from('applications').update({ status }).eq('id', id);
    if (updateAppError) { console.error('Failed to update application status:', updateAppError); return; }

    if (applicationData.user_id) {
      if (status === 'approved') {
        // 批准申请：设置为活跃状态，给予365天会员时长，并标记为已缴费
        const { error: updateMemberError } = await supabase.from('profiles').update({ 
          membership_status: 'active',
          membership_duration_days: 365,
          payment_status: 'paid'
        }).eq('id', applicationData.user_id);
        if (updateMemberError) console.error('Failed to update member status:', updateMemberError);
      } else if (status === 'rejected') {
        // 拒绝申请：设置为拒绝状态
        const { error: updateMemberError } = await supabase.from('profiles').update({ membership_status: 'rejected' }).eq('id', applicationData.user_id);
        if (updateMemberError) console.error('Failed to update member status:', updateMemberError);
      }
    }

    setApplications(applications.map(a => a.id === id ? { ...a, status } : a));
    if (status === 'approved') window.location.reload();
  };

  return (
    <div className="bg-white shadow sm:rounded-lg">
      <div className="px-4 py-5 sm:px-6">
        <h3 className="text-lg leading-6 font-medium text-gray-900">入会申请列表</h3>
      </div>
      <ul className="divide-y divide-gray-200">
        {applications.map((app) => (
          <li key={app.id} className="px-4 py-4 sm:px-6">
            <div className="flex items-center justify-between">
              <div className="flex flex-col">
                <p className="text-sm font-medium text-indigo-600 truncate">{app.full_name}</p>
                <p className="text-sm text-gray-500">{app.content}</p>
                <p className="text-xs text-gray-400">{new Date(app.created_at).toLocaleDateString()}</p>
              </div>
              <div className="flex items-center gap-2">
                {app.status === 'pending' ? (
                  <>
                    <button onClick={() => updateStatus(app.id, 'approved')} className="px-3 py-1 bg-green-600 text-white text-xs rounded-full hover:bg-green-700">批准</button>
                    <button onClick={() => updateStatus(app.id, 'rejected')} className="px-3 py-1 bg-red-600 text-white text-xs rounded-full hover:bg-red-700">拒绝</button>
                  </>
                ) : (
                  <span className={`px-3 py-1 text-xs font-semibold rounded-full ${app.status === 'approved' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
                    {app.status === 'approved' ? '已批准' : '已拒绝'}
                  </span>
                )}
              </div>
            </div>
          </li>
        ))}
      </ul>
    </div>
  );
};

## 六、数据库脚本
### 6.1 核心表结构 (db_schema.sql)
```sql
-- 用户配置文件表
create table if not exists public.profiles (
  id uuid references auth.users on delete cascade not null primary key,
  email text unique not null,
  full_name text,
  role text check (role in ('member', 'admin')) default 'member',
  membership_level text default 'General',
  membership_status text default 'pending',
  membership_duration_days INTEGER default 0,
  payment_status text default 'unpaid',
  join_date date default current_date,
  phone text,
  institution text,
  created_at timestamptz default now()
);

-- 启用行级安全性
alter table public.profiles enable row level security;

-- 创建会员申请表
create table if not exists public.applications (
  id uuid default gen_random_uuid() primary key,
  user_id uuid references public.profiles(id) on delete cascade not null,
  full_name text,
  content jsonb,
  status text default 'pending',
  created_at timestamptz default now()
);

alter table public.applications enable row level security;
```
